namespace = cs_human

country_event = {
	id = cs_human.10
	hide_window = yes
	fire_only_once = yes
    is_triggered_only = yes

	immediate = {
        country_event = { id = cs_human.100 }
        country_event = { id = cs_human.200 }
    }
}

# Connects Sol and Deneb's neighbor with wormhole 
country_event = {
	id = cs_human.100
	hide_window = yes
	fire_only_once = yes
    is_triggered_only = yes

	trigger = {
		any_system = { has_star_flag = sol_system }
		any_system = { has_star_flag = deneb_system }
	}

	immediate = {
    	random_system = {
			limit = { 
				has_star_flag = deneb_system
            }
			
			random_system = {
				limit = { 
					has_natural_wormhole = no
					distance = {
						source = prev
						use_bypasses = no
						min_jumps >= 2
						max_jumps <= 3
					}
				}

				random_system = {
					limit = { 
						has_star_flag = sol_system
					}

					prev = {
							spawn_natural_wormhole = {
							bypass_type = wormhole
							random_pos = yes
							orbit_angle = 360
						}
					}
					
					spawn_natural_wormhole = {
						bypass_type = wormhole
						random_pos = yes
						orbit_angle = 360
					}

					link_wormholes = prev
				}
			}
		}
	}
}

# Advanced start trigger for UNE if there is colony
country_event = {
	id = cs_human.200
	hide_window = yes
    is_triggered_only = yes
	fire_only_once = yes

	trigger = {
		any_system = { has_star_flag = sol_system }
		any_system = { has_star_flag = deneb_system }
	}

	immediate = {
    	random_system = {
			limit = { 
				has_star_flag = sol_system
            }
			save_global_event_target_as = sol_system
			owner = {
				if = {
					# Scope to UNE via sol and only trigger if not advanced empire
					# The check is done via tech that AE are getting since game is not saying who is and who isn't advanced 
					
					limit = { NOT { has_technology = "tech_society_1" } }
					country_event = {id = cs_human.201 }
				}
			}
		}
	}
}

# Advanced start
country_event = {
	id = cs_human.201
	hide_window = yes
    is_triggered_only = yes

	immediate = {
		# add territory
		while = {
			count = 5
			random_system_within_border = {
				limit = { 
					has_star_flag = sol_system
				}
				closest_system = {
					limit = {
						NOR = {
							exists = space_owner
							has_star_flag = hostile_system
							any_ship_in_system = { always = yes }
						}
						has_access_fleet = root
					}

					create_starbase = {
						size = starbase_outpost
						owner = root
					}
				}
			}
		}

		country_event = { 
			id = cs_human.202 
			days = 1 
		}
	}
}

# Rest of advanced start after a day. Game needs to recalculate borders 
country_event = {
	id = cs_human.202
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		# empire upgrade
		country_event = {id = game_start.6 }

		# colonies
		every_planet_within_border = {
			limit = {
				habitability = { 
					who = root.species
					value >= 0.7
				}
				is_colony = no
			}

			# colonise
			set_owner = root

			# build up
			planet_event = {id = game_start.20 }	
			planet_event = {id = game_start.21 }	
			planet_event = {id = game_start.22 }
			planet_event = {id = game_start.23 }
		}
	}
}